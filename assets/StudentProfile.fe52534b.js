import{r as c,U as A,u as C,j as e,F as D,a}from"./index.43b463e3.js";import{M as b,D as L,a as y,U as P}from"./UpdatePassword.58293a9b.js";import{A as G,F as x}from"./Form.fca9dea0.js";import{B as w}from"./Button.966cb885.js";import{C as M}from"./Container.d58f4d58.js";import"./InputGroupContext.a2e967e8.js";function F(){const[t,o]=c.exports.useState(),[l,u]=c.exports.useState([]),[r,m]=c.exports.useState("All Grades"),[i,p]=c.exports.useState(!0),[s,h]=c.exports.useState(!1),{currentUser:n,logOut:g,getStudentData:v}=A(),N=C();c.exports.useEffect(()=>{n!=null&&n.uid&&v(n==null?void 0:n.uid).then(d=>{d.exists()&&(o(d.data()),u(d.data().grades))}).catch(d=>{}).finally(()=>{h(!1)})},[n==null?void 0:n.uid,i]);const f=()=>{g(),N("/grades-portal")},k=()=>{h(!0),p(d=>!d)},j=c.exports.useMemo(()=>{const d=[];return l.forEach(S=>{d.includes(S.subject)||d.push(S.subject)}),d},[l.length]);return{student:t,grades:l,option:r,subjects:j,handleRefresh:k,refreshLoading:s,handleLogOut:f,setOption:m}}function H(){const t=c.exports.useRef(),[o,l]=c.exports.useState(!1),[u,r]=c.exports.useState(""),[m,i]=c.exports.useState(!1),p=()=>{l(!1),r("")},s=()=>l(!0),{deleteAccount:h}=A(),n=C();function g(N){if(N.preventDefault(),i(!0),t.current.value.length<6)return i(!1),r("Invalid Password.");h(t.current.value).then(f=>{if(f.status==="success")n("/grades-portal");else{switch(f.message){case"auth/wrong-password":r("Wrong password");break;case"auth/too-many-requests":r("Too many attempts to delete the account have failed please try again later.");break;default:r("Account could not be deleted")}i(!1)}}).catch(f=>{i(!1),r("Account couldn't be deleted.")})}return{currentPassword:t,show:o,alert:e(D,{children:u&&e(G,{variant:"danger",onClose:()=>r(""),dismissible:!0,children:u})}),loading:m,handleCloseModal:p,handleShowModal:s,handleDeleteAccount:g}}function R(){const{currentPassword:t,show:o,alert:l,loading:u,handleCloseModal:r,handleShowModal:m,handleDeleteAccount:i}=H();return a("div",{className:"w-100 text-center",children:[e(w,{variant:"link",onClick:m,children:"Delete Account?"}),a(b,{centered:!0,show:o,onHide:r,children:[e(b.Header,{closeButton:!0,children:e(b.Title,{children:"Delete Account"})}),e(b.Body,{children:a("div",{className:"w-100",children:[l,a(x,{onSubmit:i,children:[a(x.Group,{className:"mb-3",children:[e(x.Label,{children:"Confirm Your Password"}),e(x.Control,{type:"password",ref:t,autoComplete:"current-password",required:!0})]}),e(w,{disabled:u,className:"w-100 mt-3 mb-3",type:"submit",children:"Submit"})]})]})}),e(b.Footer,{children:e("div",{className:"w-100 text-center mt-2",children:"Note! This action is irreversible and all data will be lost permanently."})})]})]})}function W(){const{student:t,grades:o,option:l,subjects:u,handleRefresh:r,refreshLoading:m,handleLogOut:i,setOption:p}=F();return e(M,{className:"d-flex align-items-center justify-content-center",style:{minHeight:"100vh"},children:a("div",{className:"w-100",style:{maxWidth:"900px"},children:[t!=null&&t.name?a("h1",{className:" mb-4",children:["Hello ",t==null?void 0:t.name," !"]}):null,a("h4",{className:" mb-4",children:["Email: ",t==null?void 0:t.email]}),e(w,{variant:"outline-primary",className:"mb-4 mt-4",onClick:r,disabled:m,children:m?e("div",{className:"spinner-border spinner-border text-primary",style:{width:"1.5rem",height:"1.5rem"},role:"status"}):"Refresh"}),e("h3",{children:"Showing: "}),a(L,{title:l,variant:"secondary",className:"mt-2",children:[u.map((s,h)=>e(y.Item,{onClick:()=>{p(`${s}`)},children:s},h)),e(y.Item,{onClick:()=>{p("All Grades")},children:"All Grades"})]}),(o==null?void 0:o.length)>0?e("div",{className:"overflow-scroll mt-4 mb-5",style:{maxHeight:"33vh",minHeight:"15vh"},children:a("table",{className:"table h-25 table-striped",children:[e("thead",{className:"table-dark",children:a("tr",{children:[e("th",{scope:"col",children:"#"}),e("th",{scope:"col",children:"Subject"}),e("th",{scope:"col",children:"Name"}),e("th",{scope:"col",className:"text-center",children:"Grade"}),e("th",{scope:"col",className:"text-center",children:"Percentage"}),e("th",{scope:"col",className:"text-center",children:"Status"})]})}),e("tbody",{children:o.map((s,h)=>s.subject===l||l==="All Grades"?a("tr",{children:[e("th",{scope:"row",children:h+1}),e("th",{scope:"row",children:s.subject}),e("td",{children:s.name}),a("td",{className:"text-center",children:[s.mark,"/",s.total]}),a("td",{className:"text-center",children:[s.percentage,"%"]}),e("td",{className:`text-center ${s.percentage>=50?"text-success":"text-danger"}`,children:s.percentage>=50?"Passed":"Failed"})]},h):null)})]})}):e("h5",{className:"mt-4 mb-4 text-black-50",children:"**No marks were added yet**"}),e(P,{}),e(R,{}),e("div",{className:"w-100 mt-3",children:e(w,{variant:"outline-primary",className:"text-center mb-4 btn-lg mt-3",onClick:i,children:"Log out"})})]})})}export{W as default};
